using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.Json;
using System.Threading.Tasks;
using dotnet_cyberpunk_challenge_2.malware_daemons.lib;

namespace dotnet_cyberpunk_challenge_2.malware_daemons
{
    public class KuangGradeElevenMalware : KuangDaemonFamilyBase
    {
        public override async Task<ArasakaMessageResponse> GetIceTypeOnRemote()
        {
            // TODO: Challenge 3
            // We are requesting what kind of model is the ICE. The Kuang knows some memory addresses to look for that will tell
            // it what kind of ICE it is so we can use it's detection methods
            
            ArasakaMessageResponse arasakaMessageResponse = await CurrentServerConnection.SendRequest("model-type");
            string modelType = arasakaMessageResponse.content["model"];

            string matchedType = "";
            if (_IsTargetHitachiICE(/*TODO: hmm..something is missing*/)){
                // TODO: We need to set matched type to a string of the model type, i.e. Hitachi
            } else if (/*TODO: We need to check for the additional ICE model types*/) {

            }

            /*TODO: If the model type doesn't match any of the ones we know about then we need to return "unknown"
              *** Hint: Maybe we can use an "else" and use one of the protected functions in the parent class!
             */


            arasakaMessageResponse.content["message"] = matchedType;
            return arasakaMessageResponse;
        }

        public override void IceBreak()
        {
            // NOT Building this right now,
            // We will build it later!
            throw new NotImplementedException();
        }

        public override async Task<IceBreakerTunnelConnection> /*TODO: Some Function is missing here...*/()
        {
            CurrentIceBreakerTunnelConnection = new IceBreakerTunnelConnection();
            CurrentIceBreakerTunnelConnection.Initialize();
            return CurrentIceBreakerTunnelConnection;
        }
    }
}